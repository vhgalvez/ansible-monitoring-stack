---
# üß© deploy_monitoring_stack.yml
# Playbook maestro para desplegar el stack de monitoreo completo en Kubernetes.
# Compatible con ejecuci√≥n local, CI/CD y automatizaci√≥n general.

- name: Cargar variables de group_vars y ejecutar playbooks en 'controller'
  vars_files:
    - group_vars/all.yml
  hosts: controller

- name: 3Ô∏è‚É£ Desplegar stack de monitoreo completo (Prometheus + Grafana)
  import_playbook: 01_install_monitoring_stack.yml

- name: 4Ô∏è‚É£ Instalar Node Exporter en m√°quinas externas (si aplica)
  import_playbook: 02_install_node_exporter.yml

- name: 5Ô∏è‚É£ Generar y aplicar configuraci√≥n de scrapes externos
  import_playbook: 03_update_scrape_targets.yml