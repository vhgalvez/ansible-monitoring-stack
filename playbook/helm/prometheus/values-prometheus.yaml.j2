---
# helm/prometheus/values-prometheus.yaml.j2
server:
  containerPort: {{ prometheus_container_port }}  # Usar variable de Ansible

  extraArgs:
    web.listen-address: ":{{ prometheus_container_port }}"  # Variable de puerto para la dirección web

  livenessProbe:
    httpGet:
      path: /-/healthy
      port: {{ prometheus_container_port }}  # Puerto de la sonda de liveness con la variable
    initialDelaySeconds: 30
    timeoutSeconds: 5
    periodSeconds: 10
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /-/ready
      port: {{ prometheus_container_port }}  # Puerto de la sonda de readiness con la variable
    initialDelaySeconds: 30
    timeoutSeconds: 3
    periodSeconds: 5
    failureThreshold: 3

  service:
    port: {{ prometheus_service_port }}  # Puerto del servicio de Prometheus
    targetPort: {{ prometheus_container_port }}  # Puerto del contenedor que se expondrá a través del servicio

  # Recursos de Prometheus: Asegurando que tenga suficiente CPU y memoria
  resources:
    requests:
      memory: "{{ prometheus_memory_requests }}"   # Ajusta la memoria de acuerdo con el tamaño de tu entorno
      cpu: "{{ prometheus_cpu_requests }}"         # Ajusta la CPU según los recursos disponibles
    limits:
      memory: "{{ prometheus_memory_limits }}"     # Limita la memoria máxima
      cpu: "{{ prometheus_cpu_limits }}"           # Limita la CPU máxima