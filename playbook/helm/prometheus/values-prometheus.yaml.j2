server:
  service:
    type: NodePort
    port: 80
    targetPort: 9090
    nodePort: 32001

  ingress:
    enabled: true
    hosts:
      - prometheus.local
    paths:
      - /

  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1
      memory: 2Gi

  serverFiles:
    prometheus.yml:
      global:
        scrape_interval: 15s
        evaluation_interval: 15s

      scrape_configs:
        - job_name: 'kubernetes-apiservers'
          kubernetes_sd_configs:
            - role: endpoints
          relabel_configs:
            - source_labels:
                - __meta_kubernetes_namespace
                - __meta_kubernetes_service_name
                - __meta_kubernetes_endpoint_port_name
              action: keep
              regex: default;kubernetes;https

        - job_name: 'kubernetes-nodes'
          kubernetes_sd_configs:
            - role: node
          relabel_configs:
            - action: labelmap
              regex: __meta_kubernetes_node_label_(.+)

extraScrapeConfigs: |
  - job_name: 'node-exporter-externos'
    scrape_interval: 15s
    scrape_timeout: 10s
    static_configs:
      - targets:
          - "10.17.3.11:9100"
          - "10.17.3.12:9100"
          - "10.17.3.13:9100"
          - "10.17.3.14:9100"
          - "10.17.5.20:9100"
          - "192.168.0.15:9100"
        labels:
          environment: "external"
          monitored_by: "prometheus"